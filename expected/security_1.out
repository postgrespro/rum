/*
 * ------------------------------------
 *  NOTE: This test behaves differenly
 * ------------------------------------
 *
 * Since 774171c4f64 (>=18) reporting of errors in extension script files
 * is more detailed.
 *
 * security.out - test output for PostgreSQL (<18)
 * security_1.out - test output for PostgreSQL (>=18)
 *
 */
-- Check security CVE-2020-14350
CREATE FUNCTION rum_anyarray_similar(anyarray,anyarray) RETURNS bool AS $$ SELECT false $$ LANGUAGE SQL;
CREATE EXTENSION rum;
ERROR:  function "rum_anyarray_similar" already exists with same argument types
CONTEXT:  SQL statement "CREATE FUNCTION rum_anyarray_similar(anyarray,anyarray)
RETURNS bool
AS '$libdir/rum'
LANGUAGE C STRICT STABLE"
extension script file "rum--1.3.sql", near line 1530
DROP FUNCTION rum_anyarray_similar(anyarray,anyarray);
